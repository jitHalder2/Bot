<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DORAEMON</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <style>
        body {
            font-family: 'El Messiri', sans-serif;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            margin: 0;
            padding: 0;
            color: #1f2937;
        }
        :root {
            --soft-black: #1f2937;
            --light-black: #374151;
            --light-gray: #d1d5db;
            --purple: #a78bfa;
            --green: #10b981;
            --red: #ef4444;
            --orange: #f97316;
            --blue: #3b82f6;
            --yellow: #f59e0b;
            --pink: #ec4899;
            --teal: #14b8a6;
        }
        * {
            color: var(--soft-black);
        }
        .popup, .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            z-index: 1000;
            width: 90%;
            max-width: 400px;
            border: 2px solid var(--light-gray);
        }
        .popup.active, .modal.active {
            display: block;
        }
        .win-popup, .loss-popup, .pattern-warning, .history-deleted-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            z-index: 1000;
            width: 90%;
            max-width: 400px;
            border: 2px solid var(--green);
            text-align: center;
        }
        .loss-popup, .pattern-warning {
            border: 2px solid var(--red);
        }
        .history-deleted-popup {
            border: 2px solid var(--purple);
        }
        .win-popup.active, .loss-popup.active, .pattern-warning.active, .history-deleted-popup.active {
            display: block;
        }
        .confetti-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .play-resume {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            z-index: 1000;
            width: 90%;
            max-width: 400px;
            border: 2px solid var(--green);
            text-align: center;
        }
        .play-resume.active {
            display: block;
        }
        .play-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--green);
        }
        .card {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1.5rem;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            position: relative;
            margin: 0.75rem;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-6px) scale(1.03);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--green), var(--teal));
        }
        svg {
            width: 100%;
            height: auto;
            margin: 0 auto;
            display: block;
        }
        svg text {
            text-anchor: middle;
            dominant-baseline: middle;
            text-transform: uppercase;
            animation: stroke 5s infinite alternate;
            stroke-width: 1.2;
            stroke: var(--purple);
            font-size: 130px;
            fill: rgba(255, 255, 255, 0);
        }
        @media (max-width: 768px) {
            svg text { font-size: 100px; }
        }
        @keyframes stroke {
            0% { fill: rgba(255, 255, 255, 0); stroke: var(--purple); stroke-dashoffset: 25%; stroke-dasharray: 0 50%; stroke-width: 1.2; }
            70% { fill: rgba(255, 255, 255, 0); stroke: var(--blue); }
            80% { fill: rgba(255, 255, 255, 0); stroke: var(--teal); stroke-width: 2.5; }
            100% { fill: var(--light-gray); stroke: rgba(0, 0, 0, 0); stroke-dashoffset: -25%; stroke-dasharray: 50% 0; stroke-width: 0; }
        }
        .history-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: none;
            overflow: visible;
            position: relative;
        }
        .history-item {
            transition: all 0.3s ease;
            width: 100%;
            max-width: 100%;
            margin: 0;
            border-radius: 1.2rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            padding: 1.2rem;
            border-left: 4px solid transparent;
        }
        .history-item.win { border-left-color: var(--green); background: linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(255, 255, 255, 0.9)); }
        .history-item.loss { border-left-color: var(--red); background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(255, 255, 255, 0.9)); }
        .history-item.pending { border-left-color: var(--yellow); background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(255, 255, 255, 0.9)); }
        .history-item.skipped { border-left-color: var(--light-gray); background: linear-gradient(135deg, rgba(209, 213, 219, 0.08), rgba(255, 255, 255, 0.9)); }
        .history-item:hover { transform: scale(1.02); box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15); }
        .history-item.fade-out { animation: fadeOut 0.5s ease forwards; }
        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.95); height: 0; padding: 0; margin: 0; }
        }
        .history-item .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 1.5rem;
            color: rgba(0, 0, 0, 0.05);
            pointer-events: none;
            z-index: 0;
            text-transform: uppercase;
            font-weight: bold;
        }
        .small-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            background: var(--teal);
            border-radius: 50%;
            animation: float 4s infinite;
            z-index: 1;
        }
        @keyframes float {
            0% { transform: translate(0, 0); opacity: 0.9; }
            50% { transform: translate(12px, -12px); opacity: 0.5; }
            100% { transform: translate(0, 0); opacity: 0.9; }
        }
        .delete-btn:hover { color: var(--purple); transform: scale(1.3); }
        .win-badge { background: rgba(16, 185, 129, 0.15); color: var(--green); }
        .loss-badge { background: rgba(239, 68, 68, 0.15); color: var(--red); }
        .pending-badge { background: rgba(245, 158, 11, 0.15); color: var(--yellow); }
        .skipped-badge { background: rgba(209, 213, 219, 0.15); color: var(--light-gray); }
        .status-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
            overflow: hidden;
        }
        .status-icon::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            opacity: 0.2;
            background: radial-gradient(circle, currentColor 0%, transparent 70%);
        }
        .win-icon { color: var(--green); animation: pulseWin 1.5s infinite; }
        .loss-icon { color: var(--red); animation: pulseLoss 1s infinite; }
        .pending-icon { color: var(--yellow); animation: rotate 2s infinite linear; }
        .skipped-icon { color: var(--light-gray); animation: pulseSkip 1.5s infinite; }
        @keyframes pulseWin {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
        @keyframes pulseLoss {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes pulseSkip {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .dashboard-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1.5rem;
            padding: 1.2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
            transition: all 0.3s ease;
        }
        .dashboard-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15);
        }
        .confidence-meter {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        .confidence-fill {
            height: 100%;
            background: var(--green);
            transition: width 0.5s ease;
        }
        .navigation {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 350px;
            height: 70px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 1.5rem;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
        }
        .navigation ul {
            display: flex;
            width: 300px;
        }
        .navigation ul li {
            position: relative;
            list-style: none;
            width: 75px;
            height: 70px;
            z-index: 1;
        }
        .navigation ul li a {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            width: 100%;
            text-align: center;
            font-weight: 500;
        }
        .navigation ul li a .icon {
            position: relative;
            display: block;
            line-height: 75px;
            font-size: 1.5em;
            text-align: center;
            transition: 0.5s;
            color: var(--soft-black);
        }
        .navigation ul li.active a .icon { transform: translateY(-32px); color: var(--purple); }
        .navigation ul li a .text {
            position: absolute;
            font-weight: 400;
            font-size: 0.75em;
            letter-spacing: 0.05em;
            transition: 0.5s;
            opacity: 0;
            transform: translateY(20px);
            color: var(--soft-black);
        }
        .navigation ul li.active a .text { opacity: 1; transform: translateY(10px); }
        .indicator {
            position: absolute;
            top: -50%;
            width: 70px;
            height: 70px;
            background: var(--purple);
            border-radius: 50%;
            border: 6px solid var(--light-gray);
            transition: 0.5s;
        }
        .indicator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -22px;
            width: 20px;
            height: 20px;
            background: transparent;
            border-top-right-radius: 20px;
            box-shadow: 1px -10px 0 0 var(--light-gray);
        }
        .indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            right: -22px;
            width: 20px;
            height: 20px;
            background: transparent;
            border-top-left-radius: 20px;
            box-shadow: -1px -10px 0 0 var(--light-gray);
        }
        .navigation ul li:nth-child(1).active ~ .indicator { transform: translateX(calc(75px * 0)); }
        .navigation ul li:nth-child(2).active ~ .indicator { transform: translateX(calc(75px * 1)); }
        .navigation ul li:nth-child(3).active ~ .indicator { transform: translateX(calc(75px * 2)); }
        .navigation ul li:nth-child(4).active ~ .indicator { transform: translateX(calc(75px * 3)); }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; }
        .mode-toggle {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        .mode-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .mode-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--light-gray);
            transition: .4s;
            border-radius: 34px;
        }
        .mode-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: #ffffff;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .mode-slider {
            background-color: var(--green);
        }
        input:checked + .mode-slider:before {
            transform: translateX(30px);
        }
        .mode-icons {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 8px;
            pointer-events: none;
        }
        .mode-icons i, .mode-icons span {
            font-size: 14px;
            color: var(--soft-black);
        }
        .contact-links {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        .contact-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            font-size: 12px;
            color: var(--soft-black);
        }
        .contact-link i {
            font-size: 20px;
            margin-bottom: 5px;
            color: var(--purple);
        }
        .period-id {
            font-family: monospace;
            letter-spacing: 2px;
            font-size: 1.2rem;
        }
        #currentPeriod, #currentResult {
            border: none !important;
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        button, .btn {
            border-radius: 1rem;
            background: var(--green);
            backdrop-filter: blur(8px);
            transition: all 0.3s ease;
            color: #ffffff;
        }
        button:hover, .btn:hover {
            background: var(--teal);
            transform: scale(1.05);
        }
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            color: var(--soft-black);
        }
        @media (max-width: 768px) {
            .card { padding: 0.75rem; margin: 0.5rem; border-radius: 1rem; }
            .grid-cols-2 { grid-template-columns: 1fr; }
            .md\\:grid-cols-3 { grid-template-columns: 1fr 1fr; }
            .text-3xl { font-size: 1.5rem; }
            .text-2xl { font-size: 1.25rem; }
            .text-xl { font-size: 1rem; }
            .text-lg { font-size: 0.875rem; }
            .text-sm { font-size: 0.75rem; }
            .p-6 { padding: 0.75rem; }
            .p-5 { padding: 0.5rem; }
            .w-12 { width: 2.5rem; height: 2.5rem; }
            .history-item { padding: 1rem; border-radius: 1rem; }
            .history-item .watermark { font-size: 1rem; }
            .rounded-xl { border-radius: 0.75rem; }
            .gap-4 { gap: 0.75rem; }
            .mb-4 { margin-bottom: 0.75rem; }
            .mb-2 { margin-bottom: 0.5rem; }
            .mb-1 { margin-bottom: 0.3rem; }
            .px-4 { padding-left: 0.75rem; padding-right: 0.75rem; }
            .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
            .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
            .space-x-2 > * + * { margin-left: 0.5rem; }
            .space-x-1 > * + * { margin-left: 0.3rem; }
            .navigation { width: 300px; border-radius: 1rem; }
            .navigation ul { width: 250px; }
            .navigation ul li { width: 62.5px; }
            .indicator { width: 60px; height: 60px; }
            .navigation ul li:nth-child(1).active ~ .indicator { transform: translateX(calc(62.5px * 0)); }
            .navigation ul li:nth-child(2).active ~ .indicator { transform: translateX(calc(62.5px * 1)); }
            .navigation ul li:nth-child(3).active ~ .indicator { transform: translateX(calc(62.5px * 2)); }
            .navigation ul li:nth-child(4).active ~ .indicator { transform: translateX(calc(62.5px * 3)); }
            .popup, .modal, .win-popup, .loss-popup, .play-resume, .history-deleted-popup { max-width: 320px; padding: 1rem; border-radius: 1rem; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <div class="w-full relative pb-20">
        <header class="text-center mt-0 mb-2 animate__animated animate__fadeInDown">
            <svg viewBox="0 0 800 120">
                <text x="50%" y="50%">DORAEMON-AI</text>
            </svg>
        </header>

        <div class="max-w-full mx-auto p-2 w-full">
            <div class="max-w-4xl mx-auto p-2 w-full">
                <!-- Home Section -->
                <div id="homeSection" class="content-section active">
                    <div class="card mb-4 overflow-hidden gradient-bg animate__animated animate__zoomIn relative">
                        <div class="bg-white bg-opacity-95 p-6 rounded-lg pulse-animation">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="relative">
                                    <div class="pl-2">
                                        <div class="flex items-center space-x-2 mb-2">
                                            <i class="fas fa-calendar-alt text-2xl animate__animated animate__bounce"></i>
                                            <h2 class="text-2xl font-bold">Period</h2>
                                        </div>
                                        <p id="currentPeriod" class="text-2xl font-semibold bg-D1F2EB p-3 rounded-lg shadow-inner period-id">-</p>
                                    </div>
                                </div>
                                <div class="relative text-right">
                                    <div class="pr-2">
                                        <div class="flex items-center justify-end space-x-2 mb-2">
                                            <h2 class="text-2xl font-bold">Prediction</h2>
                                            <i class="fas fa-poll text-2xl animate__animated animate__bounce"></i>
                                        </div>
                                        <p id="currentResult" class="text-2xl font-semibold bg-D1F2EB p-3 rounded-lg shadow-inner">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <p class="text-sm">Confidence</p>
                                <div class="confidence-meter">
                                    <div id="confidenceFill" class="confidence-fill" style="width: 0%"></div>
                                </div>
                                <p id="confidenceText" class="text-sm mt-1">0%</p>
                            </div>
                        </div>
                        <div class="small-dot" style="top: 15%; left: 15%; animation-delay: 0.2s;"></div>
                        <div class="small-dot" style="top: 85%; left: 85%; animation-delay: 0.8s;"></div>
                        <div class="small-dot" style="top: 50%; left: 25%; animation-delay: 1.2s;"></div>
                        <div class="small-dot" style="top: 20%; left: 80%; animation-delay: 1.6s;"></div>
                    </div>

                    <div class="card mb-4 p-6 animate__animated animate__fadeInUp relative">
                        <h2 class="text-3xl font-bold text-center mb-4 relative">
                            <span class="relative z-10 pulse-animation">Analysis Dashboard</span>
                            <span class="absolute top-1/2 left-0 w-full h-2 bg-D1F2EB -translate-y-1/2 rounded-full"></span>
                        </h2>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <div class="dashboard-card animate__animated animate__fadeIn" style="animation-delay: 0s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-star text-lg"></i>
                                    <div>
                                        <p class="text-sm">Most Frequent</p>
                                        <p id="mostFrequent" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card animate__animated animate__fadeIn" style="animation-delay: 0.1s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-arrow-down text-lg"></i>
                                    <div>
                                        <p class="text-sm">Least Frequent</p>
                                        <p id="leastFrequent" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card animate__animated animate__fadeIn" style="animation-delay: 0.2s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-percentage text-lg"></i>
                                    <div>
                                        <p class="text-sm">Win Rate</p>
                                        <p id="winRate" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card animate__animated animate__fadeIn" style="animation-delay: 0.3s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-trophy text-lg"></i>
                                    <div>
                                        <p class="text-sm">Wins</p>
                                        <p id="totalWinBets" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card animate__animated animate__fadeIn" style="animation-delay: 0.4s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-skull text-lg"></i>
                                    <div>
                                        <p class="text-sm">Losses</p>
                                        <p id="totalLossBets" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card flex items-center justify-between animate__animated animate__fadeIn" style="animation-delay: 0.5s;">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-server text-lg"></i>
                                    <div>
                                        <p class="text-sm">Server Status</p>
                                        <p id="serverStatus" class="font-semibold">Connected</p>
                                    </div>
                                </div>
                                <div id="serverStatusIndicator" class="w-3 h-3 bg-90EE90 rounded-full animate-ping"></div>
                            </div>
                        </div>
                        <div class="small-dot" style="top: 10%; left: 10%; animation-delay: 0.3s;"></div>
                        <div class="small-dot" style="top: 90%; left: 90%; animation-delay: 0.9s;"></div>
                        <div class="small-dot" style="top: 30%; left: 70%; animation-delay: 1.5s;"></div>
                    </div>
                </div>

                <!-- History Section -->
                <div id="historySection" class="content-section">
                    <div class="card p-6 animate__animated animate__fadeInUp relative">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-3xl font-bold text-center relative">
                                <span class="relative z-10 pulse-animation">History</span>
                                <span class="absolute top-1/2 left-0 w-full h-2 bg-D1F2EB -translate-y-1/2 rounded-full"></span>
                            </h2>
                            <button id="deleteAllHistoryBtn" class="px-4 py-2 rounded-lg hover:bg-D1F2EB transition flex items-center">
                                <i class="fas fa-trash-alt mr-2"></i><span>Delete</span>
                            </button>
                        </div>
                        <div id="history" class="history-container"></div>
                        <div class="small-dot" style="top: 20%; left: 30%; animation-delay: 0.4s;"></div>
                        <div class="small-dot" style="top: 80%; left: 70%; animation-delay: 0.9s;"></div>
                        <div class="small-dot" style="top: 40%; left: 50%; animation-delay: 1.3s;"></div>
                    </div>
                </div>

                <!-- Stats Section -->
                <div id="statsSection" class="content-section">
                    <div class="card p-6 animate__animated animate__fadeInUp relative">
                        <h2 class="text-3xl font-bold text-center mb-4 relative">
                            <span class="relative z-10 pulse-animation">Statistics</span>
                            <span class="absolute top-1/2 left-0 w-full h-2 bg-D1F2EB -translate-y-1/2 rounded-full"></span>
                        </h2>
                        <div class="stats-grid">
                            <div class="dashboard-card">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-trophy text-green-500 text-lg"></i>
                                    <div>
                                        <p class="text-sm">Total Wins</p>
                                        <p id="statsTotalWins" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-skull text-red-500 text-lg"></i>
                                    <div>
                                        <p class="text-sm">Total Losses</p>
                                        <p id="statsTotalLosses" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-percentage text-yellow-500 text-lg"></i>
                                    <div>
                                        <p class="text-sm">Win Rate</p>
                                        <p id="statsWinRate" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-fire text-orange-500 text-lg"></i>
                                    <div>
                                        <p class="text-sm">Current Streak</p>
                                        <p id="currentStreak" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center space-x-2">
                                    <i class="fas fa-history text-blue-500 text-lg"></i>
                                    <div>
                                        <p class="text-sm">Last 5 Results</p>
                                        <p id="lastFiveResults" class="text-xl font-bold">-</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="small-dot" style="top: 15%; left: 20%; animation-delay: 0.5s;"></div>
                        <div class="small-dot" style="top: 85%; left: 80%; animation-delay: 1s;"></div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settingsSection" class="content-section">
                    <div class="card p-6 animate__animated animate__fadeInUp relative">
                        <h2 class="text-3xl font-bold text-center mb-4 relative">
                            <span class="relative z-10 pulse-animation">Settings</span>
                            <span class="absolute top-1/2 left-0 w-full h-2 bg-D1F2EB -translate-y-1/2 rounded-full"></span>
                        </h2>
                        <div class="flex flex-col gap-4">
                            <div class="dashboard-card">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-chart-line text-lg"></i>
                                        <div>
                                            <p class="text-sm">Status</p>
                                            <p id="totalWins" class="text-sm">Total Wins: 0</p>
                                            <p id="totalLosses" class="text-sm">Total Losses: 0</p>
                                        </div>
                                    </div>
                                    <p id="eligibilityStatus" class="text-sm font-semibold text-yellow-600">Pending</p>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-bell text-lg"></i>
                                        <p class="text-sm">Notifications</p>
                                    </div>
                                    <label class="mode-toggle">
                                        <input type="checkbox" id="notificationToggle">
                                        <span class="mode-slider"></span>
                                        <div class="mode-icons">
                                            <i class="fas fa-bell-slash"></i>
                                            <i class="fas fa-bell"></i>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-volume-up text-lg"></i>
                                        <p class="text-sm">Sound</p>
                                    </div>
                                    <label class="mode-toggle">
                                        <input type="checkbox" id="soundToggle" checked>
                                        <span class="mode-slider"></span>
                                        <div class="mode-icons">
                                            <i class="fas fa-volume-mute"></i>
                                            <i class="fas fa-volume-up"></i>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <div class="dashboard-card cursor-pointer hover:bg-D1F2EB transition" onclick="resetSettings()">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-undo text-lg"></i>
                                        <p class="text-sm">Reset Settings</p>
                                    </div>
                                    <span class="text-sm">Reset</span>
                                </div>
                            </div>
                            <div class="dashboard-card">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-cog text-lg"></i>
                                        <p class="text-sm">Prediction Mode</p>
                                    </div>
                                    <label class="mode-toggle">
                                        <input type="checkbox" id="predictionModeToggle">
                                        <span class="mode-slider"></span>
                                        <div class="mode-icons">
                                            <i class="fas fa-moon"></i>
                                            <i class="fas fa-bolt"></i>
                                        </div>
                                    </label>
                                </div>
                            </div>
                            <div onclick="openVideoPopup()" class="dashboard-card cursor-pointer hover:bg-D1F2EB transition">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fab fa-youtube text-lg"></i>
                                        <p class="text-sm">How To Use</p>
                                    </div>
                                    <span class="text-sm">Watch Video</span>
                                </div>
                            </div>
                            <div onclick="window.open('https://t.me/+QMFXx-6jLIc3NzNl', '_blank')" class="dashboard-card cursor-pointer hover:bg-D1F2EB transition">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fab fa-telegram text-lg"></i>
                                        <p class="text-sm">Telegram</p>
                                    </div>
                                    <span class="text-sm">Join Channel</span>
                                </div>
                            </div>
                            <div onclick="window.open('https://t.me/doraemonnobi77', '_blank')" class="dashboard-card cursor-pointer hover:bg-D1F2EB transition">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fab fa-telegram text-lg"></i>
                                        <p class="text-sm">Telegram</p>
                                    </div>
                                    <span class="text-sm">Owners</span>
                                </div>
                            </div>
                            <div onclick="window.open('l', '_blank')" class="dashboard-card cursor-pointer hover:bg-D1F2EB transition">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-shield-alt text-lg"></i>
                                        <p class="text-sm">Privacy Policy</p>
                                    </div>
                                    <span class="text-sm">Read More</span>
                                </div>
                            </div>
                            <div class="contact-links">
                                <a href="https://t.me/+QMFXx-6jLIc3NzNl" target="_blank" class="contact-link">
                                    <i class="fab fa-telegram"></i>
                                    <span>Telegram</span>
                                </a>
                                <a href="https://t.me/YOUKNOWDORAEMON" target="_blank" class="contact-link">
                                    <i class="fab fa-telegram"></i>
                                    <span>Owners</span>
                                </a>
                            </div>
                        </div>
                        <div class="small-dot" style="top: 10%; left: 15%; animation-delay: 0.6s;"></div>
                        <div class="small-dot" style="top: 90%; left: 85%; animation-delay: 1.1s;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <ul>
                <li class="active">
                    <a href="#" data-section="homeSection">
                        <span class="icon"><ion-icon name="home-outline"></ion-icon></span>
                        <span class="text">Home</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="historySection">
                        <span class="icon"><ion-icon name="time-outline"></ion-icon></span>
                        <span class="text">History</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="statsSection">
                        <span class="icon"><ion-icon name="bar-chart-outline"></ion-icon></span>
                        <span class="text">Stats</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-section="settingsSection">
                        <span class="icon"><ion-icon name="settings-outline"></ion-icon></span>
                        <span class="text">Settings</span>
                    </a>
                </li>
                <div class="indicator"></div>
            </ul>
        </div>

        <!-- Video Popup -->
        <div id="videoPopup" class="popup">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">How To Use NEWRO X</h3>
                <button onclick="closeVideoPopup()" class="hover:text-90EE90">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="video-container">
                <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allowfullscreen></iframe>
            </div>
        </div>

        <!-- Win Popup -->
        <div id="winPopup" class="win-popup">
            <div class="confetti-icon">🎉</div>
            <h3 class="text-lg font-semibold mb-4">CONGRATULATIONS!</h3>
            <p class="mb-4">You won this prediction!</p>
            <p id="winDetails" class="mb-4"></p>
        </div>

        <!-- Loss Popup -->
        <div id="lossPopup" class="loss-popup">
            <div class="confetti-icon">❌</div>
            <h3 class="text-lg font-semibold mb-4">LOSS!</h3>
            <p class="mb-4">Unfortunately, you lost this prediction.</p>
            <p id="lossDetails" class="mb-4"></p>
        </div>

        <!-- Pattern Warning Popup -->
        <div id="patternWarningPopup" class="pattern-warning">
            <div class="confetti-icon">⚠️</div>
            <h3 class="text-lg font-semibold mb-4">PATTERN WARNING!</h3>
            <p class="mb-4">5 consecutive losses detected. Pattern not good. Please wait 15 minutes before playing again.</p>
            <button onclick="pausePredictions()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition">CLOSE</button>
        </div>

        <!-- History Deleted Popup -->
        <div id="historyDeletedPopup" class="history-deleted-popup">
            <div class="confetti-icon"></div>
            <h3 class="text-lg font-semibold mb-4">HISTORY DELETED!</h3>
            <p class="mb-4">History has been successfully deleted.</p>
            <p id="historyDeleteDetails" class="mb-4"></p>
        </div>

        <!-- Play Resume Modal -->
        <div id="playResumeModal" class="play-resume">
            <div class="play-icon"><i class="fas fa-play"></i></div>
            <h3 class="text-lg font-semibold mb-4">Resume Playing</h3>
            <p class="mb-4">You can now resume predictions.</p>
            <button onclick="resumePlaying()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition">Resume</button>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmModal" class="modal">
            <h3 class="text-lg font-semibold mb-4">Confirm Action</h3>
            <p id="modalMessage" class="mb-4"></p>
            <div class="flex justify-end space-x-2">
                <button id="cancelModalBtn" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition">Cancel</button>
                <button id="confirmModalBtn" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition">Confirm</button>
            </div>
        </div>

        <script type="module">
            // Dynamic color scheme
            function getDailyColorScheme() {
                const selectedScheme = {
                    primary: '#A78BFA',
                    secondary: '#EDE9FE',
                    tertiary: '#8B5CF6',
                    text: '#4C1D95'
                };
                document.documentElement.style.setProperty('--primary-color', selectedScheme.primary);
                document.documentElement.style.setProperty('--secondary-color', selectedScheme.secondary);
                document.documentElement.style.setProperty('--tertiary-color', selectedScheme.tertiary);
                document.documentElement.style.setProperty('--text-color', selectedScheme.text);
            }
            getDailyColorScheme();

            // Global variables
            let historyData = [];
            let lastFetchedPeriod = null;
            let lastResult = null;
            let lastPrediction = null;
            let lastStatus = null;
            let lastOppositeNumber = null;
            let globalPrediction = null;
            let streak = 0;
            let winLevel = 0;
            let lossStreak = 0;
            let consecutiveLosses = 0;
            let isPaused = false;
            let isPatternGood = true;
            const MAX_WIN_LEVEL = 3;
            let isSoundEnabled = localStorage.getItem('sound') === 'true' || true;
            let isNotificationsEnabled = localStorage.getItem('notifications') === 'true' || false;
            let isAdvancedMode = localStorage.getItem('predictionMode') === 'advanced' || false;

            // Apply saved settings
            document.getElementById('notificationToggle').checked = isNotificationsEnabled;
            document.getElementById('soundToggle').checked = isSoundEnabled;
            document.getElementById('predictionModeToggle').checked = isAdvancedMode;

            // Navigation
            const navItems = document.querySelectorAll('.navigation ul li');
            const sections = document.querySelectorAll('.content-section');

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    const sectionId = item.querySelector('a').getAttribute('data-section');
                    sections.forEach(section => section.classList.remove('active'));
                    document.getElementById(sectionId).classList.add('active');
                });
            });

            // Video Popup
            function openVideoPopup() {
                document.getElementById('videoPopup').classList.add('active');
            }

            function closeVideoPopup() {
                document.getElementById('videoPopup').classList.remove('active');
            }

            // Win Popup with Auto-Close and Voice
            function showWinPopup(period, predicted, actual) {
                document.getElementById('winDetails').textContent = `Period: ${period} | Predicted: ${predicted} | Actual: ${actual}`;
                document.getElementById('winPopup').classList.add('active');
                if (isSoundEnabled) {
                    speak("congratulations You Win power by DORAEMON");
                }
                setTimeout(() => {
                    document.getElementById('winPopup').classList.remove('active');
                }, 5000);
            }

            // Loss Popup with Auto-Close and Voice
            function showLossPopup(period, predicted, actual) {
                document.getElementById('lossDetails').textContent = `Period: ${period} | Predicted: ${predicted} | Actual: ${actual}`;
                document.getElementById('lossPopup').classList.add('active');
                if (isSoundEnabled) {
                    speak("Sorry you Loss pattern not stables or my mistake");
                }
                setTimeout(() => {
                    document.getElementById('lossPopup').classList.remove('active');
                }, 5000);
            }

            // Pattern Warning Popup
            function showPatternWarningPopup() {
                document.getElementById('patternWarningPopup').classList.add('active');
            }

            // History Deleted Popup with Auto-Close
            function showHistoryDeletedPopup(message) {
                document.getElementById('historyDeleteDetails').textContent = message;
                document.getElementById('historyDeletedPopup').classList.add('active');
                if (isSoundEnabled) {
                    speak("History has been deleted successfully");
                }
                setTimeout(() => {
                    document.getElementById('historyDeletedPopup').classList.remove('active');
                }, 3000);
            }

            // Text-to-Speech Function
            function speak(text) {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'en-US';
                    utterance.volume = 1;
                    utterance.rate = 1;
                    utterance.pitch = 1;
                    speechSynthesis.speak(utterance);
                }
            }

            // Confirmation Modal
            function showConfirmModal(message, onConfirm) {
                document.getElementById('modalMessage').textContent = message;
                document.getElementById('confirmModal').classList.add('active');
                const confirmBtn = document.getElementById('confirmModalBtn');
                const cancelBtn = document.getElementById('cancelModalBtn');

                const confirmHandler = () => {
                    onConfirm();
                    document.getElementById('confirmModal').classList.remove('active');
                    confirmBtn.removeEventListener('click', confirmHandler);
                };

                confirmBtn.addEventListener('click', confirmHandler);
                cancelBtn.addEventListener('click', () => {
                    document.getElementById('confirmModal').classList.remove('active');
                });
            }

            // Play Resume Modal
            function showPlayResumeModal() {
                document.getElementById('playResumeModal').classList.add('active');
            }

            function pausePredictions() {
                document.getElementById('patternWarningPopup').classList.remove('active');
                clearInterval(predictionInterval);
                isPaused = true;
                isPatternGood = false;
                document.getElementById("currentResult").textContent = "PATTERN NOT GOOD";
                setTimeout(() => {
                    showPlayResumeModal();
                }, 15 * 60 * 1000);
                showToast("Predictions paused for 15 minutes due to unstable pattern.");
            }

            function resumePlaying() {
                document.getElementById('playResumeModal').classList.remove('active');
                isPaused = false;
                isPatternGood = true;
                predictionInterval = setInterval(updatePrediction, 5000);
                updatePrediction();
            }

            // Settings Handlers
            document.getElementById('notificationToggle').addEventListener('change', (e) => {
                isNotificationsEnabled = e.target.checked;
                localStorage.setItem('notifications', isNotificationsEnabled);
            });

            document.getElementById('soundToggle').addEventListener('change', (e) => {
                isSoundEnabled = e.target.checked;
                localStorage.setItem('sound', isSoundEnabled);
            });

            document.getElementById('predictionModeToggle').addEventListener('change', (e) => {
                isAdvancedMode = e.target.checked;
                localStorage.setProperty('predictionMode', isAdvancedMode ? 'advanced' : 'normal');
                updatePrediction();
            });

            function resetSettings() {
                showConfirmModal("Are you sure you want to reset all settings to default?", () => {
                    isSoundEnabled = true;
                    isNotificationsEnabled = false;
                    isAdvancedMode = false;
                    localStorage.setItem('sound', isSoundEnabled);
                    localStorage.setItem('notifications', isNotificationsEnabled);
                    localStorage.setItem('predictionMode', 'normal');
                    document.getElementById('notificationToggle').checked = false;
                    document.getElementById('soundToggle').checked = true;
                    document.getElementById('predictionModeToggle').checked = false;
                    updatePrediction();
                });
            }

            // Improved Prediction Algorithm with Pattern Analysis
            function analyzePattern(history) {
                if (history.length < 5) return { isStable: true, patternScore: 1 };

                const recent = history.slice(0, 5);
                let bigCount = 0;
                let smallCount = 0;
                let streakCount = 1;
                let currentStreak = 1;
                let lastResult = recent[0].resultType;

                for (let i = 0; i < recent.length; i++) {
                    if (recent[i].resultType === "BIG") bigCount++;
                    else if (recent[i].resultType === "SMALL") smallCount++;

                    if (i > 0) {
                        if (recent[i].resultType === lastResult) {
                            currentStreak++;
                            streakCount = Math.max(streakCount, currentStreak);
                        } else {
                            currentStreak = 1;
                        }
                        lastResult = recent[i].resultType;
                    }
                }

                const balanceScore = Math.abs(bigCount - smallCount) / 5;
                const streakScore = streakCount / 5;
                const patternScore = 1 - (balanceScore * 0.6 + streakScore * 0.4);

                return {
                    isStable: patternScore > 0.5,
                    patternScore: patternScore
                };
            }

            // Weighted Prediction with Pattern Adjustment
            function weightedPrediction(periodNumber, patternScore) {
                const baseWeight = 0.5 + (patternScore * 0.3);
                const trendWeight = 0.7 - (patternScore * 0.3);
                
                const predictionA = (periodNumber * 7) % 10;
                const predictionB = (periodNumber * 3) % 10;
                
                const combinedPrediction = Math.floor((baseWeight * predictionA) + (trendWeight * predictionB));
                return combinedPrediction >= 5 ? "BIG" : "SMALL";
            }

            // Helper to get opposite number
            function getOppositeNumber(prediction) {
                const smallNumbers = [0, 1, 2, 3, 4];
                const bigNumbers = [5, 6, 7, 8, 9];
                let arr = prediction === "BIG" ? smallNumbers : bigNumbers;
                return arr[Math.floor(Math.random() * arr.length)];
            }

            // Advanced AI Prediction with Pattern Analysis
            async function ultraAIPredict(history, periodNumber) {
                let prediction, confidence;

                const patternAnalysis = analyzePattern(history);
                const patternScore = patternAnalysis.patternScore;

                // Base prediction using weighted formula
                const weightedPred = weightedPrediction(Number(periodNumber.slice(-4)), patternScore);

                if (history.length < 3) {
                    prediction = weightedPred;
                    confidence = (0.4 + Math.random() * 0.2) * patternScore;
                } else {
                    let recentResults = history.filter(h => h.resultStatus !== "Pending").slice(0, 5);
                    let bigCount = 0;
                    let smallCount = 0;
                    let weight = 1;

                    for (let i = recentResults.length - 1; i >= 0; i--) {
                        let result = recentResults[i];
                        if (result.result >= 5) {
                            bigCount += weight;
                        } else {
                            smallCount += weight;
                        }
                        weight *= 1.3;
                    }

                    prediction = bigCount > smallCount ? "BIG" : "SMALL";
                    confidence = Math.min((Math.abs(bigCount - smallCount) / (bigCount + smallCount)) + 0.4, 0.95);
                    confidence *= patternScore;

                    if (weightedPred !== prediction) {
                        confidence *= 0.85;
                    } else {
                        confidence = Math.min(confidence + 0.15, 0.95);
                    }
                }

                if (winLevel >= MAX_WIN_LEVEL) {
                    prediction = prediction === "BIG" ? "SMALL" : "BIG";
                    confidence = Math.max(0.35, confidence * 0.7);
                    winLevel = 0;
                }

                return { prediction, confidence };
            }

            // Update Last Status
            function updateLastStatus(actualNumber) {
                const predictedType = lastPrediction;
                const actualType = actualNumber >= 5 ? 'BIG' : 'SMALL';
                const match = actualType === predictedType;

                lastResult = actualNumber;
                lastStatus = match ? 'WIN' : 'LOSS';

                if (match) {
                    winLevel = Math.min(winLevel + 1, MAX_WIN_LEVEL);
                    streak = streak + 1;
                    lossStreak = 0;
                    consecutiveLosses = 0;
                    showWinPopup(historyData[0].period, predictedType, actualType);
                } else {
                    winLevel = 0;
                    streak = 0;
                    lossStreak += 1;
                    consecutiveLosses += 1;
                    showLossPopup(historyData[0].period, predictedType, actualType);
                    if (consecutiveLosses >= 5) {
                        showPatternWarningPopup();
                    }
                }

                return lastStatus;
            }

            // Fetch Game Result
            async function fetchGameResult() {
                try {
                    let response = await fetch("https://api.bdg88zf.com/api/webapi/GetNoaverageEmerdList", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            pageSize: 10,
                            pageNo: 1,
                            typeId: 1,
                            language: 0,
                            random: "4a0522c6ecd8410496260e686be2a57c",
                            signature: "334B5E70A0C9B8918B0B15E517E2069C",
                            timestamp: Math.floor(Date.now() / 1000)
                        })
                    });
                    let data = await response.json();
                    return data?.data?.list?.[0] || null;
                } catch (e) {
                    console.error("API Error fetching game result:", e);
                    updateServerStatus(false);
                    return null;
                }
            }

            // Update Server Status
            function updateServerStatus(isConnected) {
                const statusElement = document.getElementById('serverStatus');
                const indicator = document.getElementById('serverStatusIndicator');
                if (isConnected) {
                    statusElement.textContent = "Connected";
                    indicator.classList.add('animate-ping', 'bg-90EE90');
                    indicator.classList.remove('bg-gray-500');
                } else {
                    statusElement.textContent = "Disconnected";
                    indicator.classList.remove('animate-ping', 'bg-90EE90');
                    indicator.classList.add('bg-gray-500');
                }
            }

            // Show Toast
            function showToast(message) {
                const toast = document.createElement("div");
                toast.className = "toast";
                toast.innerText = message;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            }

            // Update Prediction
            async function updatePrediction() {
                if (isPaused || !isPatternGood) return;

                let result = await fetchGameResult();
                if (!result || result.issueNumber === lastFetchedPeriod) return;

                updateServerStatus(true);

                if (historyData.length > 0 && historyData[0].resultStatus === "Pending") {
                    const actualNumber = Number(result.number);
                    const status = updateLastStatus(actualNumber);
                    const resultType = actualNumber >= 5 ? "BIG" : "SMALL";

                    historyData[0].result = actualNumber;
                    historyData[0].resultStatus = status;
                    historyData[0].resultType = resultType;
                    historyData[0].calculation = `Number ${actualNumber} (${resultType})`;

                    updateHistory();
                    updateStats();
                }

                const nextPeriodFull = (BigInt(result.issueNumber) + 1n).toString();
                const nextPeriod = nextPeriodFull.slice(-4);
                const aiDecision = await ultraAIPredict(historyData, nextPeriod);
                lastPrediction = aiDecision.prediction;
                lastOppositeNumber = getOppositeNumber(lastPrediction);
                globalPrediction = lastPrediction;

                document.getElementById("currentPeriod").textContent = nextPeriod;
                document.getElementById("currentResult").textContent = globalPrediction || '-';
                document.getElementById("confidenceFill").style.width = `${(aiDecision.confidence * 100).toFixed(0)}%`;
                document.getElementById("confidenceText").textContent = `${(aiDecision.confidence * 100).toFixed(0)}%`;

                historyData.unshift({
                    period: nextPeriod,
                    prediction: globalPrediction,
                    oppositeNumber: lastOppositeNumber,
                    result: "-",
                    resultStatus: "Pending",
                    resultType: "-",
                    calculation: "-",
                    confidence: (aiDecision.confidence * 100).toFixed(0)
                });

                if (historyData.length > 20) {
                    historyData.pop();
                }

                updateHistory();
                updateStats();
                lastFetchedPeriod = result.issueNumber;

                if (isNotificationsEnabled && globalPrediction) {
                    if (Notification.permission === 'granted') {
                        new Notification(`New Prediction: ${globalPrediction}`, {
                            body: `Period: ${nextPeriod}\nConfidence: ${(aiDecision.confidence * 100).toFixed(0)}%`,
                            icon: 'https://via.placeholder.com/32'
                        });
                    }
                }
            }

            // Update History
            function updateHistory() {
                const historyContainer = document.getElementById('history');
                historyContainer.innerHTML = '';

                historyData.forEach((entry, index) => {
                    const status = entry.resultStatus.toLowerCase();
                    const iconClass = {
                        win: 'fas fa-check-circle win-icon',
                        loss: 'fas fa-times-circle loss-icon',
                        pending: 'fas fa-hourglass-half pending-icon',
                        skipped: 'fas fa-ban skipped-icon'
                    }[status] || 'fas fa-question-circle';
                    const badgeClass = {
                        win: 'win-badge',
                        loss: 'loss-badge',
                        pending: 'pending-badge',
                        skipped: 'skipped-badge'
                    }[status] || '';

                    const historyItem = document.createElement('div');
                    historyItem.className = `history-item ${status} flex items-center justify-between p-4 rounded-xl`;
                    historyItem.innerHTML = `
                        <div class="watermark">DORAEMON-AI</div>
                        <div class="flex items-center space-x-3">
                            <div class="status-icon ${badgeClass}">
                                <i class="${iconClass}"></i>
                            </div>
                            <div>
                                <p class="text-lg font-semibold">${entry.period.slice(-5)}</p>
                                <p class="text-sm">Prediction: ${entry.prediction}</p>
                                ${entry.result !== "-" ? `<p class="text-sm">Actual: ${entry.result}</p>` : ''}
                                ${entry.confidence ? `<p class="text-sm">Confidence: ${entry.confidence}%</p>` : ''}
                                <p class="text-sm capitalize">${status}</p>
                            </div>
                        </div>
                        <button class="delete-btn hover:text-90EE90 transition" data-index="${index}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    `;
                    historyContainer.appendChild(historyItem);

                    historyItem.querySelector('.delete-btn').addEventListener('click', () => {
                        showConfirmModal("Are you sure you want to delete this history item?", () => {
                            const deletedPeriod = historyData[index].period;
                            historyData.splice(index, 1);
                            updateHistory();
                            updateStats();
                            showHistoryDeletedPopup(`Period ${deletedPeriod} deleted successfully`);
                        });
                    });
                });

                // Update Analysis Dashboard
                let mostFrequent = '-';
                let leastFrequent = '-';
                const numberCounts = {};
                historyData.forEach(entry => {
                    if (entry.result !== '-') {
                        numberCounts[entry.result] = (numberCounts[entry.result] || 0) + 1;
                    }
                });
                const sortedCounts = Object.entries(numberCounts).sort((a, b) => b[1] - a[1]);
                if (sortedCounts.length > 0) {
                    mostFrequent = sortedCounts[0][0];
                    leastFrequent = sortedCounts[sortedCounts.length - 1][0];
                }
                document.getElementById('mostFrequent').textContent = mostFrequent;
                document.getElementById('leastFrequent').textContent = leastFrequent;
            }

            // Update Stats
            function updateStats() {
                const wins = historyData.filter(item => item.resultStatus === "WIN").length;
                const losses = historyData.filter(item => item.resultStatus === "LOSS").length;
                const total = wins + losses;
                const accuracy = total > 0 ? ((wins / total) * 100).toFixed(2) : 0;

                document.getElementById("winRate").textContent = `${accuracy}%`;
                document.getElementById("totalWinBets").textContent = wins;
                document.getElementById("totalLossBets").textContent = losses;
                document.getElementById("statsTotalWins").textContent = wins;
                document.getElementById("statsTotalLosses").textContent = losses;
                document.getElementById("statsWinRate").textContent = `${accuracy}%`;
                document.getElementById("currentStreak").textContent = streak;
                document.getElementById("lastFiveResults").textContent = historyData.slice(0, 5).map(item => item.resultStatus === 'WIN' ? 'W' : (item.resultStatus === 'LOSS' ? 'L' : '-')).join(', ') || '-';
                document.getElementById("totalWins").textContent = `Total Wins: ${wins}`;
                document.getElementById("totalLosses").textContent = `Total Losses: ${losses}`;
            }

            // Delete All History
            document.getElementById('deleteAllHistoryBtn').addEventListener('click', () => {
                showConfirmModal("Are you sure you want to delete all history items?", () => {
                    historyData = [];
                    streak = 0;
                    winLevel = 0;
                    lossStreak = 0;
                    consecutiveLosses = 0;
                    updateHistory();
                    updateStats();
                    showHistoryDeletedPopup("All history deleted successfully");
                });
            });

            // Request Notification Permission
            if (isNotificationsEnabled && Notification.permission !== 'granted') {
                Notification.requestPermission();
            }

            // Start Prediction Updates
            let predictionInterval = setInterval(updatePrediction, 5000);
            updatePrediction();
        </script>
    </div>
</body>
</html>